---
title: å·¥å…·è°ƒç”¨
description: Agent ä½¿ç”¨å†…ç½®å·¥å…·æ‰§è¡Œæ“ä½œ
---

# å·¥å…·è°ƒç”¨ç¤ºä¾‹

å±•ç¤ºå¦‚ä½•è®© Agent ä½¿ç”¨å†…ç½®å·¥å…·ï¼ˆæ–‡ä»¶ç³»ç»Ÿã€Bash ç­‰ï¼‰ã€‚

## å®Œæ•´ä»£ç 

```go
package main

import (
    "context"
    "fmt"
    "log"
    "os"

    "github.com/wordflowlab/agentsdk/pkg/agent"
    "github.com/wordflowlab/agentsdk/pkg/provider"
    "github.com/wordflowlab/agentsdk/pkg/sandbox"
    "github.com/wordflowlab/agentsdk/pkg/store"
    "github.com/wordflowlab/agentsdk/pkg/tools"
    "github.com/wordflowlab/agentsdk/pkg/tools/builtin"
    "github.com/wordflowlab/agentsdk/pkg/types"
)

func main() {
    ctx := context.Background()

    // åˆ›å»ºå·¥å…·æ³¨å†Œè¡¨å¹¶æ³¨å†Œå†…ç½®å·¥å…·
    toolRegistry := tools.NewRegistry()
    builtin.RegisterAll(toolRegistry)

    // åˆ›å»ºä¾èµ–
    deps := &agent.Dependencies{
        ToolRegistry:     toolRegistry,
        SandboxFactory:   sandbox.NewFactory(),
        ProviderFactory:  provider.NewMultiProviderFactory(),
        Store:            store.NewMemoryStore(),
        TemplateRegistry: agent.NewTemplateRegistry(),
    }

    // åˆ›å»º Agentï¼Œå¯ç”¨å·¥å…·
    ag, err := agent.Create(ctx, &types.AgentConfig{
        TemplateID: "assistant",
        ModelConfig: &types.ModelConfig{
            Provider: "anthropic",
            Model:    "claude-sonnet-4-5",
            APIKey:   os.Getenv("ANTHROPIC_API_KEY"),
        },
        Tools: []string{"filesystem", "bash"},  // å¯ç”¨å·¥å…·
    }, deps)
    if err != nil {
        log.Fatal(err)
    }
    defer ag.Close()

    // è®¢é˜…è¿›åº¦å’Œæ§åˆ¶äº‹ä»¶
    eventCh := ag.Subscribe([]types.AgentChannel{
        types.ChannelProgress,
        types.ChannelControl,
    }, nil)

    // å¤„ç†äº‹ä»¶
    go func() {
        for envelope := range eventCh {
            switch envelope.Event.Type {
            case types.EventTypeTextDelta:
                fmt.Print(envelope.Event.TextDelta)

            case types.EventTypeToolCallRequest:
                tool := envelope.Event.ToolCall
                fmt.Printf("\n[å·¥å…·è°ƒç”¨] %s\n", tool.Name)
                fmt.Printf("[å‚æ•°] %v\n", tool.Arguments)

            case types.EventTypeToolCallResult:
                result := envelope.Event.ToolResult
                fmt.Printf("[ç»“æœ] %s\n\n", result.Content)
            }
        }
    }()

    // å‘é€éœ€è¦ä½¿ç”¨å·¥å…·çš„è¯·æ±‚
    err = ag.Send(ctx, "åˆ›å»ºä¸€ä¸ª hello.txt æ–‡ä»¶ï¼Œå†…å®¹ä¸º 'Hello, AgentSDK!'")
    if err != nil {
        log.Fatal(err)
    }

    // ç­‰å¾…å®Œæˆ
    select {}
}
```

## è¿è¡Œç¤ºä¾‹

```bash
export ANTHROPIC_API_KEY="sk-ant-xxx"
go run main.go
```

## è¾“å‡ºç¤ºä¾‹

```
æˆ‘æ¥ä¸ºæ‚¨åˆ›å»ºè¿™ä¸ªæ–‡ä»¶ã€‚

[å·¥å…·è°ƒç”¨] filesystem_write
[å‚æ•°] map[content:Hello, AgentSDK! path:hello.txt]
[ç»“æœ] æ–‡ä»¶å·²åˆ›å»º: hello.txt

æ–‡ä»¶å·²æˆåŠŸåˆ›å»ºï¼æ‚¨å¯ä»¥åœ¨å½“å‰ç›®å½•æ‰¾åˆ° hello.txt æ–‡ä»¶ã€‚
```

## å¯ç”¨çš„å†…ç½®å·¥å…·

```go
Tools: []string{
    "filesystem",  // æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
    "bash",        // Shell å‘½ä»¤
    "http",        // HTTP è¯·æ±‚
    "websearch",   // ç½‘é¡µæœç´¢
}
```

## å¤šæ­¥éª¤å·¥å…·è°ƒç”¨

Agent å¯ä»¥è‡ªåŠ¨é“¾å¼è°ƒç”¨å¤šä¸ªå·¥å…·ï¼š

```go
// è¯·æ±‚éœ€è¦å¤šæ­¥æ“ä½œ
ag.Send(ctx, "åˆ—å‡ºå½“å‰ç›®å½•çš„ .go æ–‡ä»¶ï¼Œç„¶åç»Ÿè®¡æ€»è¡Œæ•°")

// Agent ä¼šè‡ªåŠ¨ï¼š
// 1. è°ƒç”¨ bash: ls *.go
// 2. è°ƒç”¨ bash: wc -l file1.go file2.go
// 3. è¿”å›ç»Ÿè®¡ç»“æœ
```

## ç›‘æ§å·¥å…·æ‰§è¡Œ

è¯¦ç»†ç›‘æ§æ¯ä¸ªå·¥å…·è°ƒç”¨ï¼š

```go
go func() {
    for envelope := range eventCh {
        switch envelope.Event.Type {
        case types.EventTypeToolCallRequest:
            tool := envelope.Event.ToolCall
            log.Printf("ğŸ”§ è°ƒç”¨å·¥å…·: %s", tool.Name)
            log.Printf("ğŸ“¥ è¾“å…¥: %+v", tool.Arguments)

        case types.EventTypeToolCallResult:
            result := envelope.Event.ToolResult
            if result.IsError {
                log.Printf("âŒ é”™è¯¯: %s", result.Content)
            } else {
                log.Printf("âœ… æˆåŠŸ: %s", result.Content)
            }
        }
    }
}()
```

## åŒæ­¥æ¨¡å¼

å¦‚æœä¸éœ€è¦å®æ—¶ç›‘æ§ï¼Œå¯ä»¥ä½¿ç”¨åŒæ­¥ `Chat()`ï¼š

```go
result, err := ag.Chat(ctx, "åˆ›å»º hello.txt æ–‡ä»¶")
if err != nil {
    log.Fatal(err)
}

fmt.Println(result.Message.Content)
// Agent ä¼šè‡ªåŠ¨è°ƒç”¨å·¥å…·å¹¶è¿”å›æœ€ç»ˆç»“æœ
```

## ç›¸å…³èµ„æº

- [å†…ç½®å·¥å…·è¯¦è§£](../../guides/tools/builtin)
- [è‡ªå®šä¹‰å·¥å…·å¼€å‘](../../guides/tools/custom)
- [Tools API æ–‡æ¡£](../../api-reference/tools-api)
