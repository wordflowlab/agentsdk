---
title: è‡ªå®šä¹‰å·¥å…·
description: åˆ›å»ºä¸šåŠ¡ä¸“ç”¨å·¥å…·ã€Slash Commands å’Œ Agent Skills
---

# è‡ªå®šä¹‰å·¥å…·ç¤ºä¾‹

AgentSDK æä¾›äº†çµæ´»çš„å·¥å…·æ‰©å±•èƒ½åŠ›,è®©ä½ å¯ä»¥åˆ›å»ºé€‚åˆä¸šåŠ¡éœ€æ±‚çš„ä¸“ç”¨å·¥å…·ã€‚æœ¬æ–‡æ¡£ä»‹ç»ä¸‰ç§è‡ªå®šä¹‰å·¥å…·æ–¹å¼ã€‚

[æŸ¥çœ‹å®Œæ•´ä»£ç  â†’](https://github.com/wordflowlab/agentsdk/blob/main/examples/skills/main.go)

## ğŸ¯ ä¸‰ç§è‡ªå®šä¹‰æ–¹å¼

```mermaid
graph TB
    Custom[è‡ªå®šä¹‰å·¥å…·]

    Custom --> Tool[Tool æ¥å£<br/>åŸºç¡€å·¥å…·]
    Custom --> Slash[Slash Commands<br/>ç”¨æˆ·ä¸»åŠ¨è§¦å‘]
    Custom --> Skills[Agent Skills<br/>AI è‡ªåŠ¨æ¿€æ´»]

    Tool --> T1[å®ç° Tool æ¥å£]
    Tool --> T2[æ³¨å†Œåˆ° Registry]
    Tool --> T3[Agent å¯è°ƒç”¨]

    Slash --> S1[commands/ ç›®å½•]
    Slash --> S2[Markdown å®šä¹‰]
    Slash --> S3[ç”¨æˆ·è¾“å…¥ /command]

    Skills --> K1[skills/ ç›®å½•]
    Skills --> K2[è§¦å‘æ¡ä»¶]
    Skills --> K3[è‡ªåŠ¨æ³¨å…¥ SystemPrompt]

    style Custom fill:#10b981
    style Tool fill:#3b82f6
    style Slash fill:#f59e0b
    style Skills fill:#8b5cf6
```

## ğŸ”§ æ–¹å¼ 1: å®ç° Tool æ¥å£

æœ€åŸºç¡€çš„æ–¹å¼,é€‚åˆåˆ›å»ºå¯å¤ç”¨çš„å·¥å…·ã€‚

### å®šä¹‰å·¥å…·

```go
package mytools

import (
    "context"
    "fmt"

    "github.com/wordflowlab/agentsdk/pkg/tools"
)

// WeatherTool å¤©æ°”æŸ¥è¯¢å·¥å…·
type WeatherTool struct {
    apiKey string
}

// NewWeatherTool åˆ›å»ºå·¥å…·å®ä¾‹
func NewWeatherTool(config map[string]interface{}) (tools.Tool, error) {
    apiKey, ok := config["api_key"].(string)
    if !ok {
        return nil, fmt.Errorf("api_key is required")
    }

    return &WeatherTool{
        apiKey: apiKey,
    }, nil
}

// Name å·¥å…·åç§°ï¼ˆå…¨å±€å”¯ä¸€ï¼‰
func (t *WeatherTool) Name() string {
    return "weather"
}

// Description å·¥å…·æè¿°ï¼ˆä¾› LLM ç†è§£ï¼‰
func (t *WeatherTool) Description() string {
    return "Get current weather information for a city. Returns temperature, condition, humidity, and wind speed."
}

// InputSchema è¾“å…¥å‚æ•° Schemaï¼ˆJSON Schema æ ¼å¼ï¼‰
func (t *WeatherTool) InputSchema() map[string]interface{} {
    return map[string]interface{}{
        "type": "object",
        "properties": map[string]interface{}{
            "city": map[string]interface{}{
                "type":        "string",
                "description": "City name (e.g., 'Beijing', 'New York')",
            },
            "unit": map[string]interface{}{
                "type":        "string",
                "enum":        []string{"celsius", "fahrenheit"},
                "description": "Temperature unit (default: celsius)",
            },
        },
        "required": []string{"city"},
    }
}

// Execute æ‰§è¡Œå·¥å…·é€»è¾‘
func (t *WeatherTool) Execute(ctx context.Context, input map[string]interface{}, tc *tools.ToolContext) (interface{}, error) {
    // 1. è§£æè¾“å…¥å‚æ•°
    city, ok := input["city"].(string)
    if !ok {
        return nil, fmt.Errorf("city must be a string")
    }

    unit := "celsius"
    if u, ok := input["unit"].(string); ok {
        unit = u
    }

    // 2. è°ƒç”¨å¤©æ°” API
    weather, err := t.fetchWeather(city, unit)
    if err != nil {
        return nil, fmt.Errorf("failed to fetch weather: %w", err)
    }

    // 3. è¿”å›ç»“æ„åŒ–ç»“æœ
    return map[string]interface{}{
        "city":        city,
        "temperature": weather.Temperature,
        "unit":        unit,
        "condition":   weather.Condition,
        "humidity":    weather.Humidity,
        "wind_speed":  weather.WindSpeed,
        "updated_at":  weather.UpdatedAt,
    }, nil
}

// fetchWeather è°ƒç”¨å¤©æ°” API
func (t *WeatherTool) fetchWeather(city, unit string) (*WeatherData, error) {
    // å®é™…å®ç°ï¼šè°ƒç”¨ç¬¬ä¸‰æ–¹å¤©æ°” API
    // è¿™é‡Œè¿”å›æ¨¡æ‹Ÿæ•°æ®
    return &WeatherData{
        Temperature: 25.5,
        Condition:   "Sunny",
        Humidity:    60,
        WindSpeed:   12.3,
        UpdatedAt:   "2024-01-15 10:30:00",
    }, nil
}

type WeatherData struct {
    Temperature float64
    Condition   string
    Humidity    int
    WindSpeed   float64
    UpdatedAt   string
}
```

### æ³¨å†Œå·¥å…·

```go
package main

import (
    "context"
    "log"
    "os"

    "your-project/mytools"
    "github.com/wordflowlab/agentsdk/pkg/agent"
    "github.com/wordflowlab/agentsdk/pkg/tools"
    "github.com/wordflowlab/agentsdk/pkg/types"
)

func main() {
    ctx := context.Background()

    // 1. åˆ›å»ºå·¥å…·æ³¨å†Œè¡¨
    toolRegistry := tools.NewRegistry()

    // 2. æ³¨å†Œè‡ªå®šä¹‰å·¥å…·
    toolRegistry.Register("weather", mytools.NewWeatherTool)

    // 3. æ³¨å†Œ Agent æ¨¡æ¿ï¼Œå£°æ˜å·¥å…·å¯ç”¨
    templateRegistry := agent.NewTemplateRegistry()
    templateRegistry.Register(&types.AgentTemplateDefinition{
        ID:    "weather-assistant",
        Model: "claude-sonnet-4-5",
        SystemPrompt: "You are a helpful weather assistant. Use the weather tool to provide accurate weather information.",
        Tools: []interface{}{
            "weather",  // å£°æ˜å¯ä»¥ä½¿ç”¨ weather å·¥å…·
        },
    })

    // 4. åˆ›å»º Agent
    deps := createDependencies(toolRegistry, templateRegistry)
    config := &types.AgentConfig{
        TemplateID: "weather-assistant",
        ModelConfig: &types.ModelConfig{
            Provider: "anthropic",
            Model:    "claude-sonnet-4-5",
            APIKey:   os.Getenv("ANTHROPIC_API_KEY"),
        },
        // ä¼ é€’å·¥å…·é…ç½®
        ToolsConfig: map[string]interface{}{
            "weather": map[string]interface{}{
                "api_key": os.Getenv("WEATHER_API_KEY"),
            },
        },
    }

    ag, err := agent.Create(ctx, config, deps)
    if err != nil {
        log.Fatalf("Failed to create agent: %v", err)
    }
    defer ag.Close()

    // 5. ä½¿ç”¨è‡ªå®šä¹‰å·¥å…·
    result, _ := ag.Chat(ctx, "åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ")
    log.Printf("Assistant: %s", result.Text)
}
```

### ä½¿ç”¨ç¤ºä¾‹

```go
// Agent ä¼šè‡ªåŠ¨è°ƒç”¨ weather å·¥å…·
ag.Chat(ctx, "åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ")
// â†’ Tool Call: weather(city="Beijing", unit="celsius")
// â†’ Response: "åŒ—äº¬ä»Šå¤©å¤©æ°”æ™´æœ—ï¼Œæ¸©åº¦ 25.5Â°Cï¼Œæ¹¿åº¦ 60%ï¼Œé£é€Ÿ 12.3 km/h"

ag.Chat(ctx, "çº½çº¦å’Œä¸œäº¬å“ªä¸ªåŸå¸‚æ›´çƒ­ï¼Ÿ")
// â†’ Tool Call 1: weather(city="New York")
// â†’ Tool Call 2: weather(city="Tokyo")
// â†’ Response: "æ ¹æ®å½“å‰å¤©æ°”æ•°æ®ï¼Œçº½çº¦æ¸©åº¦ 28Â°Cï¼Œä¸œäº¬æ¸©åº¦ 32Â°Cï¼Œä¸œäº¬æ›´çƒ­ã€‚"
```

## ğŸ“ æ–¹å¼ 2: Slash Commands

ç”¨æˆ·ä¸»åŠ¨è§¦å‘çš„å‘½ä»¤ç³»ç»Ÿï¼Œé€‚åˆç‰¹å®šå·¥ä½œæµã€‚

### å‘½ä»¤å®šä¹‰æ ¼å¼

åœ¨ `workspace/commands/` ç›®å½•åˆ›å»º Markdown æ–‡ä»¶ï¼š

**`commands/analyze.md`:**

```markdown
---
description: åˆ†æä»£ç è´¨é‡
argument-hint: [æ–‡ä»¶è·¯å¾„]
allowed-tools: ["fs_read", "bash_run"]
models:
  preferred:
    - claude-sonnet-4-5
    - gpt-4-turbo
  minimum-capabilities:
    - tool-calling
scripts:
  sh: scripts/bash/check-git-status.sh
  ps1: scripts/powershell/check-git-status.ps1
---

# ä»£ç è´¨é‡åˆ†æ

## ä»»åŠ¡ç›®æ ‡

åˆ†ææŒ‡å®šæ–‡ä»¶æˆ–ç›®å½•çš„ä»£ç è´¨é‡ï¼ŒåŒ…æ‹¬ï¼š
- ä»£ç é£æ ¼ä¸€è‡´æ€§
- æ½œåœ¨çš„ Bug
- æ€§èƒ½é—®é¢˜
- å®‰å…¨éšæ‚£

## æ‰§è¡Œæ­¥éª¤

1. **è¯»å–æ–‡ä»¶**
   - ä½¿ç”¨ fs_read è¯»å–æ–‡ä»¶å†…å®¹
   - å¦‚æœæ˜¯ç›®å½•ï¼Œé€’å½’è¯»å–æ‰€æœ‰æ–‡ä»¶

2. **è¿è¡Œé™æ€åˆ†æ**
   - ä½¿ç”¨ bash_run æ‰§è¡Œ linter
   - æ”¶é›†æ‰€æœ‰è­¦å‘Šå’Œé”™è¯¯

3. **ç”ŸæˆæŠ¥å‘Š**
   - æŒ‰ä¸¥é‡ç¨‹åº¦åˆ†ç±»é—®é¢˜
   - æä¾›ä¿®å¤å»ºè®®
   - ä¿å­˜æŠ¥å‘Šåˆ° analysis-report.md

## è¾“å‡ºæ ¼å¼

ä½¿ç”¨ä»¥ä¸‹æ ¼å¼è¾“å‡ºæŠ¥å‘Šï¼š

```markdown
# ä»£ç è´¨é‡åˆ†ææŠ¥å‘Š

## æ¦‚è¦
- æ–‡ä»¶æ•°: XX
- é—®é¢˜æ•°: XX
  - ğŸ”´ ä¸¥é‡: XX
  - ğŸŸ¡ è­¦å‘Š: XX
  - ğŸ”µ å»ºè®®: XX

## è¯¦ç»†é—®é¢˜

### ğŸ”´ ä¸¥é‡é—®é¢˜
1. [æ–‡ä»¶:è¡Œå·] é—®é¢˜æè¿°
   - å»ºè®®: ä¿®å¤æ–¹æ¡ˆ

...
```

## æ³¨æ„äº‹é¡¹

- åˆ†æå¤§å‹é¡¹ç›®æ—¶ï¼Œå…ˆè¯¢é—®ç”¨æˆ·æ˜¯å¦ç»§ç»­
- ä½¿ç”¨ offset å’Œ limit åˆ†æ®µè¯»å–å¤§æ–‡ä»¶
- è¶…æ—¶æ—¶é—´è®¾ç½®ä¸º 300 ç§’
```

### é…ç½® Agent æ”¯æŒ Slash Commands

```go
package main

import (
    "context"
    "log"

    "github.com/wordflowlab/agentsdk/pkg/agent"
    "github.com/wordflowlab/agentsdk/pkg/types"
)

func main() {
    ctx := context.Background()

    // åˆ›å»º Agent é…ç½®
    config := &types.AgentConfig{
        TemplateID: "code-assistant",
        ModelConfig: &types.ModelConfig{
            Provider: "anthropic",
            Model:    "claude-sonnet-4-5",
            APIKey:   os.Getenv("ANTHROPIC_API_KEY"),
        },
        Sandbox: &types.SandboxConfig{
            Kind:    types.SandboxKindLocal,
            WorkDir: "./workspace",
        },
        // é…ç½® Skills Package
        SkillsPackage: &types.SkillsPackageConfig{
            Source:      "local",
            Path:        "./workspace",
            CommandsDir: "commands",     // Slash Commands ç›®å½•
            SkillsDir:   "skills",       // Skills ç›®å½•
            EnabledCommands: []string{
                "analyze",  // å¯ç”¨ /analyze å‘½ä»¤
                "refactor",  // å¯ç”¨ /refactor å‘½ä»¤
                "document",  // å¯ç”¨ /document å‘½ä»¤
            },
        },
    }

    ag, err := agent.Create(ctx, config, deps)
    if err != nil {
        log.Fatalf("Failed to create agent: %v", err)
    }
    defer ag.Close()

    // ä½¿ç”¨ Slash Command
    testSlashCommands(ctx, ag)
}
```

### ä½¿ç”¨ Slash Commands

```go
func testSlashCommands(ctx context.Context, ag *agent.Agent) {
    // ç”¨æˆ·è¾“å…¥ /analyze å‘½ä»¤
    result, err := ag.Chat(ctx, "/analyze src/main.go")

    // Agent å·¥ä½œæµç¨‹:
    // 1. æ£€æµ‹åˆ° /analyze å¼€å¤´
    // 2. åŠ è½½ commands/analyze.md å®šä¹‰
    // 3. æ‰§è¡Œå‰ç½®è„šæœ¬ï¼ˆå¦‚æœæœ‰ï¼‰
    // 4. æ¸²æŸ“æç¤ºè¯æ¨¡æ¿
    // 5. è°ƒç”¨ LLM æ‰§è¡Œä»»åŠ¡
    // 6. ä½¿ç”¨ allowed-tools ä¸­çš„å·¥å…·
    // 7. ç”Ÿæˆåˆ†ææŠ¥å‘Š

    if err != nil {
        log.Printf("Command failed: %v", err)
    } else {
        log.Printf("Report: %s", result.Text)
    }
}
```

### å‘½ä»¤å‚æ•°å¤„ç†

```go
// Agent ä¼šè‡ªåŠ¨è§£æå‚æ•°
ag.Chat(ctx, "/analyze src/")              // å‚æ•°: "src/"
ag.Chat(ctx, "/refactor main.go --dry-run") // å‚æ•°: "main.go --dry-run"
ag.Chat(ctx, "/document")                  // æ— å‚æ•°
```

## ğŸ§  æ–¹å¼ 3: Agent Skills

AI è‡ªåŠ¨æ¿€æ´»çš„çŸ¥è¯†åº“ç³»ç»Ÿï¼Œé€‚åˆå¢å¼º Agent èƒ½åŠ›ã€‚

### Skill å®šä¹‰æ ¼å¼

åœ¨ `workspace/skills/` ç›®å½•åˆ›å»ºå­ç›®å½•å’Œ `SKILL.md` æ–‡ä»¶ï¼š

**`skills/api-security/SKILL.md`:**

```markdown
---
name: api-security
description: API å®‰å…¨æœ€ä½³å®è·µæ£€æŸ¥å™¨
allowed-tools: ["fs_read", "bash_run", "http_request"]
triggers:
  - type: keyword
    keywords: ["å®‰å…¨", "security", "API", "è®¤è¯", "æˆæƒ"]
  - type: context
    condition: "analyzing_api_code"
  - type: file_pattern
    patterns: ["**/api/**", "**/routes/**"]
---

# API å®‰å…¨æ£€æŸ¥ Skill

## è‡ªåŠ¨æ¿€æ´»æ¡ä»¶

å½“æ£€æµ‹åˆ°ä»¥ä¸‹æƒ…å†µæ—¶ï¼Œæ­¤ Skill è‡ªåŠ¨æ¿€æ´»ï¼š
- ç”¨æˆ·æåˆ°"API å®‰å…¨"ã€"è®¤è¯"ã€"æˆæƒ"ç­‰å…³é”®è¯
- æ­£åœ¨åˆ†æ API ç›¸å…³ä»£ç 
- è¯»å– api/ æˆ– routes/ ç›®å½•çš„æ–‡ä»¶

## çŸ¥è¯†åº“

### å¸¸è§ API å®‰å…¨é—®é¢˜

1. **è®¤è¯æ¼æ´**
   - ç¼ºå°‘è®¤è¯æ£€æŸ¥
   - å¼±å¯†ç ç­–ç•¥
   - Token æ³„éœ²é£é™©

2. **æˆæƒæ¼æ´**
   - è¶Šæƒè®¿é—®ï¼ˆIDORï¼‰
   - ç¼ºå°‘æƒé™éªŒè¯
   - ä¸å½“çš„è§’è‰²è®¾è®¡

3. **æ•°æ®æ³„éœ²**
   - æ•æ„Ÿæ•°æ®æ˜æ–‡ä¼ è¾“
   - é”™è¯¯ä¿¡æ¯æš´éœ²è¿‡å¤š
   - æ—¥å¿—è®°å½•æ•æ„Ÿä¿¡æ¯

4. **æ³¨å…¥æ”»å‡»**
   - SQL æ³¨å…¥
   - NoSQL æ³¨å…¥
   - Command æ³¨å…¥

### æ£€æŸ¥æ¸…å•

ä½¿ç”¨ä»¥ä¸‹æ¸…å•æ£€æŸ¥ API å®‰å…¨æ€§ï¼š

- [ ] æ‰€æœ‰ API ç«¯ç‚¹éƒ½éœ€è¦è®¤è¯
- [ ] ä½¿ç”¨ HTTPS ä¼ è¾“æ•°æ®
- [ ] å®ç°è¯·æ±‚é¢‘ç‡é™åˆ¶
- [ ] éªŒè¯æ‰€æœ‰è¾“å…¥å‚æ•°
- [ ] ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢é˜²æ­¢æ³¨å…¥
- [ ] å®ç°é€‚å½“çš„ CORS ç­–ç•¥
- [ ] æ•æ„Ÿæ“ä½œéœ€è¦äºŒæ¬¡ç¡®è®¤
- [ ] å®šæœŸè½®æ¢ API å¯†é’¥
- [ ] è®°å½•å®‰å…¨å®¡è®¡æ—¥å¿—

### ä¿®å¤å»ºè®®æ¨¡æ¿

å‘ç°é—®é¢˜æ—¶ï¼Œä½¿ç”¨æ­¤æ¨¡æ¿æä¾›å»ºè®®ï¼š

```
âš ï¸  å‘ç°å®‰å…¨é—®é¢˜: [é—®é¢˜ç±»å‹]

ğŸ“ ä½ç½®: [æ–‡ä»¶:è¡Œå·]

ğŸ” é—®é¢˜æè¿°:
[è¯¦ç»†æè¿°]

ğŸ’¡ ä¿®å¤å»ºè®®:
[å…·ä½“ä¿®å¤æ–¹æ¡ˆä»£ç ]

ğŸ“š å‚è€ƒèµ„æ–™:
- [ç›¸å…³æ–‡æ¡£é“¾æ¥]
```

## ä½¿ç”¨å·¥å…·

æ­¤ Skill å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å·¥å…·ï¼š
- `fs_read` - è¯»å–ä»£ç æ–‡ä»¶
- `bash_run` - è¿è¡Œå®‰å…¨æ‰«æå·¥å…·
- `http_request` - æµ‹è¯• API ç«¯ç‚¹
```

### é…ç½® Agent æ”¯æŒ Skills

```go
func main() {
    config := &types.AgentConfig{
        TemplateID: "security-auditor",
        ModelConfig: &types.ModelConfig{
            Provider: "anthropic",
            Model:    "claude-sonnet-4-5",
            APIKey:   os.Getenv("ANTHROPIC_API_KEY"),
        },
        SkillsPackage: &types.SkillsPackageConfig{
            Source:    "local",
            Path:      "./workspace",
            SkillsDir: "skills",
            EnabledSkills: []string{
                "api-security",      // API å®‰å…¨æ£€æŸ¥
                "code-review",       // ä»£ç å®¡æŸ¥
                "performance-tips",  // æ€§èƒ½ä¼˜åŒ–å»ºè®®
            },
        },
    }

    ag, err := agent.Create(ctx, config, deps)
    // ...
}
```

### Skills è‡ªåŠ¨æ¿€æ´»

```go
// ç¤ºä¾‹ 1: å…³é”®è¯è§¦å‘
ag.Chat(ctx, "è¿™ä¸ª API æœ‰å®‰å…¨é—®é¢˜å—ï¼Ÿ")
// â†’ api-security skill è‡ªåŠ¨æ¿€æ´»
// â†’ Agent å…·æœ‰ API å®‰å…¨çŸ¥è¯†

// ç¤ºä¾‹ 2: æ–‡ä»¶æ¨¡å¼è§¦å‘
ag.Chat(ctx, "è¯·åˆ†æ api/users.go æ–‡ä»¶")
// â†’ æ£€æµ‹åˆ°æ–‡ä»¶è·¯å¾„åŒ¹é… **/api/**
// â†’ api-security skill è‡ªåŠ¨æ¿€æ´»

// ç¤ºä¾‹ 3: ä¸Šä¸‹æ–‡è§¦å‘
ag.Chat(ctx, "åˆ†æè¿™æ®µä»£ç çš„å®‰å…¨æ€§ï¼š[ä»£ç ]")
// â†’ æ£€æµ‹åˆ°ä¸Šä¸‹æ–‡æ˜¯å®‰å…¨åˆ†æ
// â†’ api-security skill è‡ªåŠ¨æ¿€æ´»
```

## ğŸ¨ å®Œæ•´ç¤ºä¾‹ï¼šå¤šå·¥å…·ç»„åˆ

### æ•°æ®åº“ç®¡ç†å·¥å…·

```go
// database_tool.go
package mytools

type DatabaseTool struct {
    connString string
}

func NewDatabaseTool(config map[string]interface{}) (tools.Tool, error) {
    connString := config["connection_string"].(string)
    return &DatabaseTool{connString: connString}, nil
}

func (t *DatabaseTool) Name() string {
    return "database_query"
}

func (t *DatabaseTool) Description() string {
    return "Execute SQL queries on the database. Supports SELECT, INSERT, UPDATE, DELETE."
}

func (t *DatabaseTool) InputSchema() map[string]interface{} {
    return map[string]interface{}{
        "type": "object",
        "properties": map[string]interface{}{
            "query": map[string]interface{}{
                "type":        "string",
                "description": "SQL query to execute",
            },
            "params": map[string]interface{}{
                "type":        "array",
                "description": "Query parameters (optional)",
            },
        },
        "required": []string{"query"},
    }
}

func (t *DatabaseTool) Execute(ctx context.Context, input map[string]interface{}, tc *tools.ToolContext) (interface{}, error) {
    query := input["query"].(string)

    // å®‰å…¨æ£€æŸ¥
    if isSafeQuery(query) {
        return nil, fmt.Errorf("dangerous query rejected")
    }

    // æ‰§è¡ŒæŸ¥è¯¢
    rows, err := t.executeQuery(ctx, query)
    if err != nil {
        return nil, err
    }

    return map[string]interface{}{
        "rows":     rows,
        "count":    len(rows),
        "executed": true,
    }, nil
}
```

### Slash Command: /backup

**`commands/backup.md`:**

```markdown
---
description: å¤‡ä»½æ•°æ®åº“
allowed-tools: ["database_query", "bash_run", "fs_write"]
---

# æ•°æ®åº“å¤‡ä»½å‘½ä»¤

## æ‰§è¡Œæµç¨‹

1. ä½¿ç”¨ database_query å¯¼å‡ºæ‰€æœ‰æ•°æ®
2. ä½¿ç”¨ bash_run å‹ç¼©å¤‡ä»½æ–‡ä»¶
3. ä½¿ç”¨ fs_write ä¿å­˜å¤‡ä»½å…ƒæ•°æ®
4. ç”Ÿæˆå¤‡ä»½æŠ¥å‘Š

## å¤‡ä»½æ ¼å¼

- æ–‡ä»¶å: backup-YYYYMMDD-HHMMSS.sql.gz
- ä½ç½®: ./backups/
- å…ƒæ•°æ®: backup-metadata.json
```

### Skill: database-optimization

**`skills/database-optimization/SKILL.md`:**

```markdown
---
name: database-optimization
description: æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–å»ºè®®
triggers:
  - type: keyword
    keywords: ["æ…¢æŸ¥è¯¢", "ä¼˜åŒ–", "ç´¢å¼•", "æ€§èƒ½"]
---

# æ•°æ®åº“ä¼˜åŒ– Skill

## ä¼˜åŒ–ç­–ç•¥

1. **ç´¢å¼•ä¼˜åŒ–**
   - WHERE æ¡ä»¶å­—æ®µ
   - JOIN è¿æ¥å­—æ®µ
   - ORDER BY æ’åºå­—æ®µ

2. **æŸ¥è¯¢ä¼˜åŒ–**
   - é¿å… SELECT *
   - ä½¿ç”¨ LIMIT åˆ†é¡µ
   - å‡å°‘å­æŸ¥è¯¢

3. **ç»“æ„ä¼˜åŒ–**
   - é€‚å½“çš„æ•°æ®ç±»å‹
   - è¡¨åˆ†åŒº
   - è¯»å†™åˆ†ç¦»
```

### ä½¿ç”¨ç»„åˆ

```go
func main() {
    // æ³¨å†Œæ‰€æœ‰å·¥å…·
    toolRegistry.Register("database_query", mytools.NewDatabaseTool)

    // é…ç½® Agent
    config := &types.AgentConfig{
        TemplateID: "db-admin",
        SkillsPackage: &types.SkillsPackageConfig{
            Source: "local",
            Path:   "./workspace",
            EnabledCommands: []string{"backup", "restore", "migrate"},
            EnabledSkills:   []string{"database-optimization", "sql-security"},
        },
        ToolsConfig: map[string]interface{}{
            "database_query": map[string]interface{}{
                "connection_string": os.Getenv("DB_CONNECTION"),
            },
        },
    }

    ag, _ := agent.Create(ctx, config, deps)

    // ä½¿ç”¨åœºæ™¯ 1: Slash Command
    ag.Chat(ctx, "/backup")

    // ä½¿ç”¨åœºæ™¯ 2: è‡ªå®šä¹‰å·¥å…· + Skill
    ag.Chat(ctx, "æŸ¥è¯¢ç”¨æˆ·è¡¨ï¼Œä¼˜åŒ–è¿™ä¸ªæŸ¥è¯¢")
    // â†’ database_query å·¥å…·æ‰§è¡ŒæŸ¥è¯¢
    // â†’ database-optimization skill è‡ªåŠ¨æ¿€æ´»
    // â†’ æä¾›ä¼˜åŒ–å»ºè®®
}
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. Tool æ¥å£å®ç°

```go
// âœ… å¥½çš„å®è·µ

// 1. éªŒè¯è¾“å…¥
func (t *MyTool) Execute(ctx context.Context, input map[string]interface{}, tc *tools.ToolContext) (interface{}, error) {
    // æ£€æŸ¥å¿…éœ€å­—æ®µ
    value, ok := input["required_field"].(string)
    if !ok {
        return nil, fmt.Errorf("required_field must be a string")
    }

    // éªŒè¯å€¼èŒƒå›´
    if len(value) > 1000 {
        return nil, fmt.Errorf("value too long (max 1000 chars)")
    }

    // ...
}

// 2. æä¾›æ¸…æ™°çš„ Schema
func (t *MyTool) InputSchema() map[string]interface{} {
    return map[string]interface{}{
        "type": "object",
        "properties": map[string]interface{}{
            "field": map[string]interface{}{
                "type":        "string",
                "description": "Clear description of what this field does",
                "examples":    []string{"example1", "example2"},
            },
        },
        "required": []string{"field"},
    }
}

// 3. è¿”å›ç»“æ„åŒ–æ•°æ®
func (t *MyTool) Execute(...) (interface{}, error) {
    return map[string]interface{}{
        "status":  "success",
        "data":    result,
        "message": "Operation completed successfully",
    }, nil
}

// âŒ ä¸å¥½çš„å®è·µ

// 1. ä¸éªŒè¯è¾“å…¥
func (t *BadTool) Execute(...) (interface{}, error) {
    value := input["field"].(string)  // å¯èƒ½ panic
    // ...
}

// 2. æ¨¡ç³Šçš„æè¿°
func (t *BadTool) Description() string {
    return "Does something"  // å¤ªæ¨¡ç³Š
}

// 3. è¿”å›å­—ç¬¦ä¸²
func (t *BadTool) Execute(...) (interface{}, error) {
    return "success", nil  // éš¾ä»¥è§£æ
}
```

### 2. Slash Commands è®¾è®¡

```markdown
<!-- âœ… å¥½çš„å‘½ä»¤å®šä¹‰ -->

---
description: å…·ä½“ã€æ¸…æ™°çš„æè¿°
argument-hint: [å¿…éœ€å‚æ•°] [å¯é€‰å‚æ•°]
allowed-tools: ["tool1", "tool2"]  # åªå£°æ˜éœ€è¦çš„å·¥å…·
---

# å‘½ä»¤åç§°

## ä»»åŠ¡ç›®æ ‡
æ˜ç¡®è¯´æ˜æ­¤å‘½ä»¤è¦å®Œæˆä»€ä¹ˆä»»åŠ¡

## æ‰§è¡Œæ­¥éª¤
1. ç¬¬ä¸€æ­¥åšä»€ä¹ˆ
2. ç¬¬äºŒæ­¥åšä»€ä¹ˆ
3. ...

## è¾“å‡ºæ ¼å¼
ä½¿ç”¨ Markdown ä»£ç å—å±•ç¤ºæœŸæœ›çš„è¾“å‡ºæ ¼å¼

## æ³¨æ„äº‹é¡¹
- é‡è¦çš„æç¤º
- è¾¹ç•Œæƒ…å†µå¤„ç†

<!-- âŒ ä¸å¥½çš„å‘½ä»¤å®šä¹‰ -->

---
description: åšä¸€äº›äº‹æƒ…  # å¤ªæ¨¡ç³Š
---

åšç‚¹ä»€ä¹ˆ...  # æ²¡æœ‰ç»“æ„ï¼Œæ²¡æœ‰æ¸…æ™°çš„æŒ‡å¯¼
```

### 3. Skills è§¦å‘æ¡ä»¶

```markdown
<!-- âœ… å¥½çš„è§¦å‘æ¡ä»¶ -->

triggers:
  # å…³é”®è¯: å…·ä½“ã€ä¸å†²çª
  - type: keyword
    keywords: ["APIå®‰å…¨", "è®¤è¯æ¼æ´", "SQLæ³¨å…¥"]

  # æ–‡ä»¶æ¨¡å¼: ç²¾ç¡®åŒ¹é…
  - type: file_pattern
    patterns: ["**/api/**/*.go", "**/routes/**/*.js"]

  # ä¸Šä¸‹æ–‡: æ˜ç¡®çš„ä¸Šä¸‹æ–‡çŠ¶æ€
  - type: context
    condition: "security_audit"

<!-- âŒ ä¸å¥½çš„è§¦å‘æ¡ä»¶ -->

triggers:
  # å¤ªå®½æ³›ï¼Œå®¹æ˜“è¯¯è§¦å‘
  - type: keyword
    keywords: ["ä»£ç ", "æ–‡ä»¶", "æ£€æŸ¥"]

  # æ¨¡å¼å¤ªå®½ï¼ŒåŒ¹é…æ‰€æœ‰æ–‡ä»¶
  - type: file_pattern
    patterns: ["**/*"]
```

### 4. é”™è¯¯å¤„ç†

```go
// âœ… æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
func (t *MyTool) Execute(...) (interface{}, error) {
    result, err := t.doSomething()
    if err != nil {
        return nil, fmt.Errorf("failed to do something (input=%v): %w", input, err)
    }

    if !isValid(result) {
        return nil, fmt.Errorf("invalid result: expected format X, got Y")
    }

    return result, nil
}

// âŒ é”™è¯¯ä¿¡æ¯ä¸æ˜ç¡®
func (t *BadTool) Execute(...) (interface{}, error) {
    result, err := t.doSomething()
    if err != nil {
        return nil, err  // æ²¡æœ‰ä¸Šä¸‹æ–‡
    }
    return result, nil
}
```

## â“ å¸¸è§é—®é¢˜

### Q: Toolã€Commandã€Skill å¦‚ä½•é€‰æ‹©ï¼Ÿ

| åœºæ™¯ | æ¨èæ–¹å¼ | åŸå›  |
|------|---------|------|
| å¯å¤ç”¨çš„åŸºç¡€åŠŸèƒ½ | Tool æ¥å£ | è·¨ Agent ä½¿ç”¨ |
| å›ºå®šå·¥ä½œæµ | Slash Command | ç”¨æˆ·ä¸»åŠ¨è§¦å‘ |
| é¢†åŸŸçŸ¥è¯†å¢å¼º | Agent Skill | AI è‡ªåŠ¨æ¿€æ´» |
| ç¬¬ä¸‰æ–¹ API é›†æˆ | Tool æ¥å£ | æ ‡å‡†åŒ–æ¥å£ |
| å¤æ‚å¤šæ­¥éª¤ä»»åŠ¡ | Slash Command | æµç¨‹åŒ–æŒ‡å¯¼ |

### Q: Skills ä¼šå¢åŠ  Token ä½¿ç”¨å—ï¼Ÿ

ä¼šçš„ã€‚æ¿€æ´»çš„ Skills ä¼šè¢«æ³¨å…¥åˆ° SystemPromptï¼Œå ç”¨ Tokenã€‚å»ºè®®ï¼š
- åªå¯ç”¨å¿…éœ€çš„ Skills
- è®¾è®¡ç²¾ç¡®çš„è§¦å‘æ¡ä»¶
- Skills å†…å®¹ç®€æ´æ˜äº†

### Q: å¦‚ä½•è°ƒè¯•è‡ªå®šä¹‰å·¥å…·ï¼Ÿ

```go
// æ·»åŠ æ—¥å¿—
func (t *MyTool) Execute(ctx context.Context, input map[string]interface{}, tc *tools.ToolContext) (interface{}, error) {
    log.Printf("[MyTool] Input: %+v", input)

    result, err := t.process(input)

    log.Printf("[MyTool] Result: %+v, Error: %v", result, err)

    return result, err
}

// å•å…ƒæµ‹è¯•
func TestMyTool_Execute(t *testing.T) {
    tool := &MyTool{}

    result, err := tool.Execute(context.Background(), map[string]interface{}{
        "field": "test-value",
    }, &tools.ToolContext{})

    assert.NoError(t, err)
    assert.Equal(t, "expected", result)
}
```

### Q: å¯ä»¥åŠ¨æ€æ·»åŠ å·¥å…·å—ï¼Ÿ

å¯ä»¥ï¼åœ¨è¿è¡Œæ—¶æ³¨å†Œï¼š

```go
// åŠ¨æ€æ³¨å†Œå·¥å…·
toolRegistry.Register("new-tool", func(config map[string]interface{}) (tools.Tool, error) {
    return &NewTool{}, nil
})

// æ›´æ–° Agent æ¨¡æ¿
templateRegistry.Register(&types.AgentTemplateDefinition{
    ID:    "updated-assistant",
    Tools: []interface{}{"existing-tool", "new-tool"},
})
```

## ğŸ”— ç›¸å…³èµ„æº

- [Tool æ¥å£è§„èŒƒ](/api-reference/tools) - API è¯¦ç»†æ–‡æ¡£
- [å†…ç½®å·¥å…·å‚è€ƒ](/examples/tools/builtin) - å­¦ä¹ å†…ç½®å·¥å…·å®ç°
- [MCP é›†æˆ](/examples/tools/mcp) - æ‰©å±•å¤–éƒ¨å·¥å…·
- [å®Œæ•´ç¤ºä¾‹ä»£ç ](https://github.com/wordflowlab/agentsdk/tree/main/examples/skills)
